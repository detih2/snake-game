"""
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Backend –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ Pydantic Settings.

–ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?
-------------
Pydantic Settings ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± –∑–∞–≥—Ä—É–∂–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env —Ñ–∞–π–ª–∞)
—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —Ç–∏–ø–æ–≤. –ï—Å–ª–∏ –∫–∞–∫–∞—è-—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
–∏–ª–∏ –∏–º–µ–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø ‚Äî –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∏ –ø–æ–∫–∞–∂–µ—Ç –ø–æ–Ω—è—Ç–Ω—É—é –æ—à–∏–±–∫—É.

–ü–æ—á–µ–º—É –Ω–µ –ø—Ä–æ—Å—Ç–æ os.getenv()?
-----------------------------
1. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ (—Å—Ç—Ä–æ–∫–∞, —á–∏—Å–ª–æ, bool) –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
2. –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
3. –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ IDE
4. –ï–¥–∏–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
"""

from pydantic import Field
from pydantic_settings import BaseSettings, SettingsConfigDict


class DatabaseSettings(BaseSettings):
    """–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö SQLite."""
    
    model_config = SettingsConfigDict(env_prefix="DB_")
    
    # –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    # SQLite —Ö—Ä–∞–Ω–∏—Ç –≤—Å—é –ë–î –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ ‚Äî —ç—Ç–æ –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
    url: str = Field(
        default="sqlite+aiosqlite:///./snake.db",
        description="URL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ SQLite –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö"
    )


class GameSettings(BaseSettings):
    """–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã."""
    
    model_config = SettingsConfigDict(env_prefix="GAME_")
    
    # –°–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤ —Ç–∞–±–ª–∏—Ü–µ –ª–∏–¥–µ—Ä–æ–≤
    leaderboard_size: int = Field(
        default=10,
        description="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ –ª–∏–¥–µ—Ä–æ–≤"
    )
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏–º—è –∏–≥—Ä–æ–∫–∞
    max_player_name_length: int = Field(
        default=20,
        description="–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –∏–º–µ–Ω–∏ –∏–≥—Ä–æ–∫–∞"
    )


class Settings(BaseSettings):
    """
    –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
    
    –°–æ–±–∏—Ä–∞–µ—Ç –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ.
    –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
        from settings import settings
        print(settings.db.url)
    """
    
    model_config = SettingsConfigDict(
        env_file=".env",
        env_file_encoding="utf-8",
        extra="ignore",  # –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–∏—à–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ .env
    )
    
    # –í–ª–æ–∂–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    db: DatabaseSettings = DatabaseSettings()
    game: GameSettings = GameSettings()
    
    # –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ ‚Äî –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –∏ –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É
    debug: bool = Field(
        default=True,
        description="–†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏"
    )
    
    # –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API)
    app_name: str = Field(
        default="üêç Snake Game API",
        description="–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"
    )
    
    # –†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–ª—è CORS
    # CORS = Cross-Origin Resource Sharing
    # –≠—Ç–æ –Ω—É–∂–Ω–æ —á—Ç–æ–±—ã frontend (localhost:5173) –º–æ–≥ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ backend (localhost:8000)
    cors_origins: list[str] = Field(
        default=["http://localhost:5173", "http://127.0.0.1:5173", "http://localhost:3000"],
        description="–†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ origins –¥–ª—è CORS"
    )


# Singleton ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –º–æ–¥—É–ª—è
# –¢–µ–ø–µ—Ä—å –≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ –∫–æ–¥–∞ –º–æ–∂–Ω–æ: from settings import settings
settings = Settings()
